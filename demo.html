<html>

<head>
</head>

<body>

  <form id="signup">
    <div class="row">
      <label for="given_name">Given Name</label>
      <input id="given_name" name="given_name" />
    </div>
    <div class="row">
      <label for="surname">Surname</label>
      <input id="surname" name="surname" />
    </div>
    <div class="row">
      <label for="email">Email</label>
      <input id="email" name="email" />
    </div>
    <div class="row">
      <label for="username">Username</label>
      <input id="username" name="username" />
    </div>
    <div class="row">
      <label for="password">Password</label>
      <input id="password" name="password" />
    </div>
    <div class="row">
      <button type="submit" name="submit">Signup</button>
    </div>
  </form>

  <script src="./src/check-form.js"></script>
  <script>
    var signupForm = document.getElementById('signup');
    console.log(signupForm);

    var EMAIL = /^[A-Za-z][A-Za-z0-9]{2,}[@][A-Za-z0-9\-]+[.][A-Za-z0-9]{2,}$/;

    function validName(key, value, callback) {
      value = value ? value.trim() : '';
      var valid = /^[A-Za-z][A-Za-z\-]{2,}$/.test(value);

      callback({
        valid: valid,
        value: value,
        reason: valid ? '' : key + ' must not contain non-letter characters.'
      });
    }

    var checkForm = new Form({
      fields: {
        given_name: validName,
        surname: validName,
        email: function(key, value, callback) {
          value = value ? value.trim() : '';
          var valid = EMAIL.test(value);

          callback({
            valid: valid,
            value: value,
            reason: valid ? '' : 'invalid email.'
          });
        },
        username: function(key, value, callback) {
          value = value ? value.trim() : '';
          var valid = /^[A-Za-z][A-Za-z0-9]{2,}$/.test(value);

          callback({
            valid: valid,
            value: value,
            reason: value.length < 3 ?
              'username must be at least 3 characters.' : valid ?
              '' : 'username must not contain special characters.'
          });

        },
        password: function(key, value, callback) {
          value = value || '';
          var valid = value.length >= 6;

          callback({
            valid: valid,
            value: value,
            reason: valid ?
              '' : 'password must be at least 6 characters.'
          });
        }
      },
      action: function(data, callback) {
        // do something with data
        console.log('data', data);
        // callback( error, success )
      },
      error: function(validation) {
        // do something with validation
        console.log('validation', validation);
        // {
        //     <field-name>: {
        //         valid: <Boolean>,
        //         value: <input-value>,
        //         reason: <error-message>
        //     },
        //     ...
        // }
      }
    });
    checkForm.bind(signupForm)

  </script>
</body>

</html>
